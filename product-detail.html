<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å•†å“è©³æƒ…é </title>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <link rel="stylesheet" href="CSS/style.css">
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
  <script src="JS/main.js" defer></script>
  <script src="JS/products.js"></script>
</head>
<body>

  <!-- å°è¦½åˆ— -->
  <nav class="navbar navbar-expand-lg navbar-dark  sticky-top " >
    <a class="navbar-brand " id="nav_title" href="index.html">GOï¼èµ·ä¾†åœ˜è³¼ç¶²</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">       
      <ul class="navbar-nav mr-auto">
        <li class="nav-item active"><a class="nav-link"id ="nav_text" href="index.html">é¦–é </a></li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" id ="nav_text" href="products.html" id="productDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            åœ˜è³¼å•†å“ä¾†çœ‹é€™
          </a>
          <div class="dropdown-menu" aria-labelledby="productDropdown">
            <a class="dropdown-item" href="products.html#household">ç”Ÿæ´»ç”¨å“</a>
            <a class="dropdown-item" href="products.html#food">ç¾é£Ÿ</a>
            <a class="dropdown-item" href="products.html#coupon">é¤åˆ¸</a>
          </div>
        </li>
      </ul>
      <a href="wishlist.html" id ="nav_botton" class="btn btn-outline-warning mr-2" style="border-radius: 15px; border-color: #d4a373; ">â¤ï¸ æ”¶è—æ¸…å–®</a>
      <a href="cart.html" id ="nav_botton" class="btn btn-outline-light mr-2" style="border-radius: 15px; border-color: #d4a373; ">ğŸ›’ è³¼ç‰©è»Š</a>
      <a href="member.html" id ="nav_botton" class="btn btn-outline-light mr-2" style="border-radius: 15px; border-color: #d4a373; ">ğŸ‘¤ æœƒå“¡ä¸­å¿ƒ</a>
      <a href="#" id ="nav_botton" class="btn btn-outline-light" data-toggle="modal" data-target="#authModal" style="border-radius: 15px; border-color: #d4a373; ">ç™»å…¥ / è¨»å†Š</a>
    </div>
  </nav>
  <!-- ç™»å…¥ / è¨»å†Š Modal -->
  <div class="modal fade" id="authModal" tabindex="-1" role="dialog" aria-labelledby="authModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content">
        <div class="modal-header border-0">
          <h5 class="modal-title" id="authModalLabel">æœƒå“¡ç™»å…¥ / è¨»å†Š</h5>
          <button type="button" class="close text-light" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true" style="color: black;">&times;</span>
          </button>
        </div>
        <div class="modal-body" >
          <!-- Nav tabs -->
          <ul class="nav nav-tabs mb-3" role="tablist">
            <li class="nav-item">
              <a class="nav-link active" data-toggle="tab" href="#loginTab" role="tab" style="color: #03045e;font-size: 15px;">ç™»å…¥</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" data-toggle="tab" href="#registerTab" role="tab" style="color: #03045e; font-size: 15px;">è¨»å†Š</a>
            </li>
          </ul>
  
          <!-- Tab panes -->
          <div class="tab-content">
            <div class="tab-pane active" id="loginTab" role="tabpanel">
              <form>
                <div class="form-group">
                  <label for="loginEmail">å¸³è™Ÿ</label>
                  <input type="email" class="form-control" id="loginEmail" placeholder="è¼¸å…¥Email">
                </div>
                <div class="form-group">
                  <label for="loginPassword">å¯†ç¢¼</label>
                  <input type="password" class="form-control" id="loginPassword" placeholder="è¼¸å…¥å¯†ç¢¼">
                </div>
                <button type="submit" class="btn  btn-block" style="background-color: #a0c4ff;">ç™»å…¥</button>
              </form>
            </div>
            <div class="tab-pane" id="registerTab" role="tabpanel">
              <form>
                <div class="form-group">
                  <label for="registerEmail">å¸³è™Ÿ</label>
                  <input type="email" class="form-control" id="registerEmail" placeholder="è¼¸å…¥Email">
                </div>
                <div class="form-group">
                  <label for="registerPassword">å¯†ç¢¼</label>
                  <input type="password" class="form-control" id="registerPassword" placeholder="è¼¸å…¥å¯†ç¢¼">
                </div>
                <div class="form-group">
                  <label for="confirmPassword">ç¢ºèªå¯†ç¢¼</label>
                  <input type="password" class="form-control" id="confirmPassword" placeholder="å†æ¬¡è¼¸å…¥å¯†ç¢¼">
                </div>
                <button type="submit" class="btn  btn-block" style="background-color: #a0c4ff;">è¨»å†Š</button>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- å•†å“è©³æƒ…å…§å®¹ -->
  <div class="container mt-5">
    <div class="row">
      <div class="col-md-6">
        <img id="product-image" src="" class="img-fluid mb-3" alt="å•†å“åœ–">
      </div>
      <div class="col-md-6 ">
        <h2 id="product-name"></h2>
        <p id="product-price" class="h4" style="color: #9b2226;"></p>
        <p id="product-description"></p>

        <label for="quantity">é¸æ“‡æ•¸é‡ï¼š</label>
        <input type="number" id="quantity" class="form-control w-25 mb-3" value="1" min="1">

        <button class="btn btn-outline-warning btn-block mb-3" onclick="addToCart()">åŠ å…¥è³¼ç‰©è»Š</button>
        <button id="wishlist-btn" class="btn btn-outline-danger btn-block mb-3">â¤ï¸ æ”¶è—</button>

        <p>å•†å“è©•åˆ†ï¼š</p>
        <div id="star-rating">
          â˜…â˜…â˜…â˜…â˜…
        </div>
      </div>
    </div>

    <hr class="bg-secondary">

    <!-- ä½¿ç”¨è€…è©•åƒ¹èˆ‡ç•™è¨€å€ -->
    <div >
      <h4>æ–°å¢è©•è«–</h4>
      <form id="review-form" class="mb-4">
        <div class="form-group">
          <label for="reviewer">æš±ç¨±</label>
          <input type="text" class="form-control" id="reviewer" required>
        </div>
        <div class="form-group">
          <label for="rating">è©•åˆ†</label>
          <select class="form-control w-25" id="rating" required>
            <option value="5">â˜…â˜…â˜…â˜…â˜…</option>
            <option value="4">â˜…â˜…â˜…â˜…â˜†</option>
            <option value="3">â˜…â˜…â˜…â˜†â˜†</option>
            <option value="2">â˜…â˜…â˜†â˜†â˜†</option>
            <option value="1">â˜…â˜†â˜†â˜†â˜†</option>
          </select>
        </div>
        <div class="form-group">
          <label for="comment">ç•™è¨€</label>
          <textarea class="form-control" id="comment" rows="3" required></textarea>
        </div>
        <button type="submit" class="btn btn-outline-warning">é€å‡º</button>
      </form>

      <h5>å¹³å‡è©•åˆ†ï¼š<span id="average-rating">å°šç„¡è©•åˆ†</span></h5>
      <div id="reviews-container"></div>
    </div>

    <hr class="bg-secondary">

    <!-- è©•è«–å€ -->
    <div >
      <h4>é¡§å®¢è©•è«–</h4>
      <div class=" mb-3" style="height: 50px;border: 1px black solid; background-color: #e3d5ca;padding: 10px 5px;">
        <strong>ä½¿ç”¨è€…Aï¼š</strong> è¶…è®šçš„å•†å“ï¼Œå›è³¼å¥½å¹¾æ¬¡äº†ï¼â˜…â˜…â˜…â˜…â˜…
      </div>
      <div class=" mb-3" style="height: 50px;border: 1px black solid; background-color: #e3d5ca; padding: 10px 5px;">
        <strong>ä½¿ç”¨è€…Bï¼š</strong> å“è³ªå¾ˆå¥½ï¼Œé€è²¨ä¹Ÿå¾ˆå¿«ï¼Œæ¨è–¦ï¼â˜…â˜…â˜…â˜…â˜†
      </div>
    </div>
  </div>

  <!-- é å°¾ -->
  <footer class="text-center py-3" id="footer_all" >
    GOï¼èµ·ä¾†åœ˜è³¼ç¶² &copy; 2025 - æ‰€æœ‰æ¬Šåˆ©ä¿ç•™
  </footer>

  <script>
    function addToCart() {
        const product = {
            name: document.getElementById("product-name").textContent,
            price: parseInt(document.getElementById("product-price").dataset.price),
            quantity: parseInt(document.getElementById("quantity").value),
        };

        let cart = JSON.parse(localStorage.getItem("cart")) || [];
        const existing = cart.find(item => item.name === product.name);
        if (existing) {
            existing.quantity += product.quantity;
        } else {
            cart.push(product);
        }

        localStorage.setItem("cart", JSON.stringify(cart));
        alert(`å·²å°‡ ${product.quantity} ä»¶å•†å“åŠ å…¥è³¼ç‰©è»Šï¼`);
    }
  </script>

  <script>
    window.onload = () => {
      const urlParams = new URLSearchParams(window.location.search);
      const idParam   = urlParams.get("id") || urlParams.get("product");
      const nameParam = urlParams.get("name");
      const product = products.find(p =>
          (idParam   && p.id   === parseInt(idParam)) ||
          (nameParam && p.name === decodeURIComponent(nameParam))
      );

      if (product) {
        document.getElementById("product-name").textContent = product.name;
        document.getElementById("product-price").innerHTML = 
          `åœ˜è³¼åƒ¹ NT$${product.price} <del class="text-muted ml-3">åŸåƒ¹ NT$${product.originalPrice}</del>`;
        document.getElementById("product-price").dataset.price = product.price;
        document.getElementById("product-description").textContent = product.description;
        document.getElementById("product-image").src = product.image;
        document.getElementById("product-image").alt = product.name;
        // æ”¶è—æŒ‰éˆ•åŠŸèƒ½
        document.getElementById("wishlist-btn").addEventListener("click", () => {
          const wishlist = JSON.parse(localStorage.getItem("wishlist")) || [];
          const exists = wishlist.some(item => item.name === product.name);
          if (!exists) {
            wishlist.push(product);
            localStorage.setItem("wishlist", JSON.stringify(wishlist));
            alert(`å·²æ”¶è— ${product.name}ï¼`);
          } else {
            alert(`${product.name} å·²åœ¨æ”¶è—æ¸…å–®ä¸­ã€‚`);
          }
        });
      }
    };

  </script>

  <script>
  document.addEventListener("DOMContentLoaded", () => {
    const urlParams = new URLSearchParams(window.location.search);
    const idParam = urlParams.get("id") || urlParams.get("product");
    const productId = parseInt(idParam);

    const form = document.getElementById("review-form");
    const reviewsContainer = document.getElementById("reviews-container");
    const averageRatingDisplay = document.getElementById("average-rating");

    function renderReviews() {
      const reviews = JSON.parse(localStorage.getItem("reviews_" + productId)) || [];
      reviewsContainer.innerHTML = "";
      if (reviews.length === 0) {
        reviewsContainer.innerHTML = "<p class='text-muted'>å°šç„¡ç•™è¨€</p>";
        averageRatingDisplay.textContent = "å°šç„¡è©•åˆ†";
        return;
      }

      let totalRating = 0;
      reviews.forEach(r => {
        totalRating += r.rating;
        const stars = "â˜…â˜…â˜…â˜…â˜…â˜†â˜†â˜†â˜†â˜†".slice(5 - r.rating, 10 - r.rating);
        const div = document.createElement("div");
        div.className = "border p-3 mb-2";
        div.innerHTML = `<strong>${r.name}</strong>ï¼ˆ${r.date}ï¼‰<br>${stars}<br>${r.comment}`;
        reviewsContainer.appendChild(div);
      });
      const avg = (totalRating / reviews.length).toFixed(1);
      averageRatingDisplay.textContent = `${avg} é¡†æ˜Ÿ (${reviews.length} ç­†)`;
    }

    form.addEventListener("submit", e => {
      e.preventDefault();
      const name = document.getElementById("reviewer").value.trim();
      const rating = parseInt(document.getElementById("rating").value);
      const comment = document.getElementById("comment").value.trim();
      if (!name || !comment || !rating) return;

      const review = {
        name,
        rating,
        comment,
        date: new Date().toLocaleString()
      };
      const reviews = JSON.parse(localStorage.getItem("reviews_" + productId)) || [];
      reviews.push(review);
      localStorage.setItem("reviews_" + productId, JSON.stringify(reviews));

      form.reset();
      renderReviews();
    });

    renderReviews();
  });
</script>
</body>
</html>